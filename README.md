# Static and Dynamic Malware Analysis Using Online Investigation Tools.
## Objectives
The first section of the malware analysis lab demonstrates how static analysis is performed by submitting an indicator of compromise(IOC) to a collection of antimalware programs and analyzing the returned result. This section leverages the Virus Total online investigation tool. 
The second section performs Dynamic analysis by dissecting the malware at the binary level. This is done by leveraging ANY.RUN online tool.
The lab's primary focus is to prove that a flagged potential IOC is True Positive.
## Skills Learned
+ Malware analysis
+ Enhanced knowledge of Indicators Of Compromise(IOC).

## Resources/ Tools /Utilities
+ Virtual Machine(Cisco's CSE-LABVM).
+ Internet Access.
+ VirusTool.
+ File hash: 05383088d0d46a5b5f4de852703601a6c39f04844ab63a1850197fcb011f3c81
+ Any.Run.

## STATIC MALWARE ANALYSIS WITH VIRUSTOTAL ONLINE INVESTIGATION TOOL
To start finding information about the file open the VirusTotal website using the URL https://www.virustotal.com/gui/home/upload. The VirusTotal interface is displayed:

<img width="956" alt="virustotal interface1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/3730fd1f-e1d0-4e4c-ba8b-e2a1e2829bf5">

##

Click the SEARCH from the VirusTotal menu. Next, copy the file hash, paste it into the field provided and press enter:

<img width="950" alt="click search and past file hash in the field belo1w" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/101c74e5-33e1-4214-a07b-2fe516a7f2da">

##

VirusTotal uploaded the file hash publicly to be scanned and the result was returned. 
The first section of the scan result shows a Community Score scoring the file hash 47 out of 63. It indicates its propensity to be a malicious file.

<img width="948" alt="scan result 1png" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/1ffc1e7b-8bc9-4dca-adb8-c887c39493d4">

##

The second section contains six tabs each with information related to the uploaded file hash:

***DETECTION:*** This tab explains the activities of the code executed by the file making it malicious

<img width="948" alt="second result dtect" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/7104dd14-3f23-47a7-94d9-95281538f8bc">

This section also displays the Security industries' detection of the malware, the malware name, and the tools used for detection in VirusTotal. It also shows that the threat category is Trojan.

<img width="948" alt="scan result2" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/a97d96dc-d2cf-47ed-bccb-7c26045c1647">

***DETAILS:*** This tab shows the filetype to be a Microsoft Word document named with the following names Data-5544-J5823545.doc, 460_01_11_2021_20_31_08_460_1610390811wcgyle.doc.MRG, DocX69688X4511225.doc. The tab provides attributes that aid in further investigation.

<img width="952" alt="second detail1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/73ddb342-67df-41e6-9e9f-950fab7eb6a2">

***RELATION:*** This tab shows IOCs related to the malware. The IOCs included domains, IP addresses, websites, and files. This also aids in further investigation or detection.

<img width="954" alt="second relat1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/ebe769d8-cc6a-486e-afe8-5bab045cb137">

***BEHAVIOUR:*** This tab provides an activity summary of the malware. It also indicates that malware is executed through the PowerShell command line. It also shows what the malware exhibits when running on an endpoint device.

<img width="952" alt="second behave1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/267718de-1d91-49e6-9092-9b91631a897d">

***COMMUNITY:*** This tab displays analysis done by malware Analysts.

<img width="949" alt="second commu1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/41cb8fd8-5a6a-4899-a238-b251ce9fe86e">

## DYNAMIC MALWARE ANALYSIS WITH ANY.RUN ONLINE INVESTIGATION TOOL
To submit IOC to ANY.RUN for analysis, navigate https://any.run. Click SERVICE on the menu and the Service interface is displayed.

***ANY.RUN Welcome page***

<img width="955" alt="anyrun interface" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/749b45be-9044-4852-bae5-1678f2966a9a">

##

***Sandbox Service Interface***
The sandbox Service dashboard shows the real-time current malware threat landscape. It provides 24-hour statistics on public submission of malware analysis.
To submit the file hash for analysis, click Public Tasks to launch the public submission page:

<img width="954" alt="sandbox interafcee1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/26e133b5-70f7-4c64-a8ba-7486442ca775">

##
The public submission page displays the most recent submission of malware analysis first. To submit the file hash for analysis copy and paste it into the search box:

<img width="955" alt="public sub interf1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/d59e38e9-6b36-47fa-af8c-caa30b0ef402">

##

The displayed page shows the public submission of malware artifacts corresponding to the submitted file hash. The name of the public submission is the same as the file detected in the VirusTotal analysis:

<img width="386" alt="malware name AR1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/472ba3fc-1c33-427d-a69c-b0aaec7bc6d3">
<img width="382" alt="malware name VT" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/7bac33bb-0d00-42d8-81cc-cc16ff2e7440">

##
To further analyze the malware behavior, click the public submission dated 1 June 2019.

<img width="954" alt="select 1june1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/8108885a-3ff5-41fd-b726-1bde53f4de65">

##

The computer desktop that is shown is a screenshot of the different stages of the infection 

<img width="355" alt="malware behav1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/0011923b-4f92-4f56-9067-c7d312199971">
<img width="355" alt="mal bhav1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/c03f8e2b-7199-4bb6-8433-e57c9c7a2960">
<img width="355" alt="me bev1" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/fdd8acf7-b7a7-460e-8616-3151a977c853">

The screenshots reveal that the MS Word document is responsible for the initial infection. The text in the Second image suggests that the malware required the user to enable Editing and Content.

##

The malware activities section in the top-right corner shows the processes involved in the infection. Each tree-like tab represents a process in the malware activity and displays details about the process when clicked in the bottom-right corner. The first process is WINWORD.EXE which indicates a legit Windows process. it can be verified from the bottom-right detail pane that the malware was passed through this initial process. 
The file Data-5544-J5823545.doc corresponding to the submitted file hash was passed in the WINWORD.EXE process.

<img width="954" alt="winwo" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/59e80fb5-6470-4907-83fc-3aad8fa27809">

##
Now click powershell.exe and the detail process pane shows a long string passed to the Command line. click More Info to view additional details.

<img width="953" alt="powersh" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/807bf493-363e-473b-a0c2-045d4d874b67">

##

The advanced details of the PowerShell process show the events in the execution. It also shows the timeline of the process. The description of the long string  inputted into the command line is explained using Chatgpt 3.5 technology.

<img width="954" alt="pow more" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/d39f9f70-86f2-4cd2-bd4c-1a4517bf72f2">

From the ChatGPT malware analysis report, the long string is a PowerShell script leveraging base64 encoding to obfuscate the script to avoid detection.

<img width="954" alt="power gpt" src="https://github.com/richard-acquah/Malware-Analysis-Lab/assets/136107996/fef027cd-e2f2-4d1a-b48e-aa5d9a2f5c0f">

## conclusion



